// carrd-google-sheet.js

var GOOGLE_APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw2EuJoknXIjrbDYb8jrIJtnOlg6hbaQqEFK9udC9lIp9JsXD6kjEWRdSXVOSYrsIeg/exec";
var GOOGLE_SHEET_ID = "1O2SRGHuiGE0X6KCCKcRYvOaX4g0GU8Qk8BrooeVONxE";
var SHEET_NAME = "2025";
var TABLE_ID = "table01";

function readJson(data) {
    var container = document.getElementById(TABLE_ID);
    var sheetData = data[SHEET_NAME];

    if (!sheetData || !sheetData.length) {
        container.innerHTML = "<p>No data found in sheet.</p>";
        return;
    }

    container.innerHTML = "";

    var table = document.createElement("table");
    table.style.width = "100%";
    table.style.borderCollapse = "collapse";
    container.appendChild(table);

    var headers = [];
    for (var key in sheetData[0]) { headers.push(key); }

    var thead = document.createElement("thead");
    var trHead = document.createElement("tr");
    for (var i = 0; i < headers.length; i++) {
        var th = document.createElement("th");
        th.textContent = headers[i];
        th.style.border = "1px solid #ccc";
        th.style.padding = "5px";
        trHead.appendChild(th);
    }
    thead.appendChild(trHead);
    table.appendChild(thead);

    var tbody = document.createElement("tbody");
    for (var r = 0; r < sheetData.length; r++) {
        var tr = document.createElement("tr");
        for (var c = 0; c < headers.length; c++) {
            var td = document.createElement("td");
            td.textContent = sheetData[r][headers[c]] || "";
            td.style.border = "1px solid #ccc";
            td.style.padding = "5px";
            tr.appendChild(td);
        }
        tbody.appendChild(tr);
    }
    table.appendChild(tbody);
}

function loadJsonp(url, callback) {
    var script = document.createElement('script');
    script.src = url + '&callback=' + callback;
    document.body.appendChild(script);
}

// Start JSONP request
loadJsonp(GOOGLE_APPS_SCRIPT_URL + '?id=' + GOOGLE_SHEET_ID + '&sheet=' + SHEET_NAME, 'readJson');
